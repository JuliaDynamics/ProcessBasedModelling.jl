<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Documentation · ProcessBasedModelling.jl</title><meta name="title" content="Documentation · ProcessBasedModelling.jl"/><meta property="og:title" content="Documentation · ProcessBasedModelling.jl"/><meta property="twitter:title" content="Documentation · ProcessBasedModelling.jl"/><meta name="description" content="Documentation for ProcessBasedModelling.jl."/><meta property="og:description" content="Documentation for ProcessBasedModelling.jl."/><meta property="twitter:description" content="Documentation for ProcessBasedModelling.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>ProcessBasedModelling.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Documentation</a><ul class="internal"><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Special-handling-of-timescales"><span>Special handling of timescales</span></a></li><li><a class="tocitem" href="#Main-API-function"><span>Main API function</span></a></li><li><a class="tocitem" href="#predefined_processes"><span>Predefined <code>Process</code> subtypes</span></a></li><li><a class="tocitem" href="#Process-API"><span><code>Process</code> API</span></a></li><li><a class="tocitem" href="#Automatic-named-parameters"><span>Automatic named parameters</span></a></li><li><a class="tocitem" href="#Utility-functions"><span>Utility functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling" href="#ProcessBasedModelling"><code>ProcessBasedModelling</code></a> — <span class="docstring-category">Module</span></header><section><div><p><strong>ProcessBasedModelling.jl</strong></p><p><a href="https://juliadynamics.github.io/ProcessBasedModelling.jl/dev/"><img src="https://img.shields.io/badge/docs-dev-lightblue.svg" alt="docsdev"/></a> <a href="https://juliadynamics.github.io/ProcessBasedModelling.jl/stable/"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="docsstable"/></a> <a href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/actions?query=workflow%3ACI"><img src="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/workflows/CI/badge.svg" alt="CI"/></a> <a href="https://codecov.io/gh/JuliaDynamics/ProcessBasedModelling.jl"><img src="https://codecov.io/gh/JuliaDynamics/ProcessBasedModelling.jl/branch/main/graph/badge.svg" alt="codecov"/></a> <a href="https://pkgs.genieframework.com?packages=ProcessBasedModelling"><img src="https://shields.io/endpoint?url=https://pkgs.genieframework.com/api/v1/badge/ProcessBasedModelling" alt="Package Downloads"/></a></p><p>ProcessBasedModelling.jl is an extension to <a href="https://docs.sciml.ai/ModelingToolkit/stable/">ModelingToolkit.jl</a> (MTK) for building a model of equations using symbolic expressions. It is an alternative framework to MTK&#39;s <a href="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/acausal_components/">native component-based modelling</a>, but, instead of components, there are &quot;processes&quot;. This approach is useful in the modelling of physical/biological/whatever systems, where each variable corresponds to a particular physical concept or observable and there are few (or none) duplicate variables to make the definition of MTK &quot;factories&quot; worthwhile. On the other hand, there plenty of different physical representations, or <em>processes</em> to represent a given physical concept. In many scientific fields this approach parallels the modelling reasoning of the researcher more closely than the &quot;components&quot; approach.</p><p>Beyond this reasoning style, the biggest strength of ProcessBasedModelling.jl is the <strong>informative errors and automation</strong> it provides regarding incorrect/incomplete equations. When building the MTK model via ProcessBasedModelling.jl the user provides a vector of &quot;processes&quot;: equations or custom types that have a well defined and single left-hand-side variable. This allows ProcessBasedModelling.jl to:</p><ol><li>Iterate over the processes and collect <em>new</em> variables that have been introduced by a provided process but do not themselves have a process assigned to them.</li><li>For these collected &quot;process-less&quot; variables:<ul><li>If there is a default process defined, incorporate this one into the model</li><li>If there is no default process but the variable has a default value, equate the variable to a <em>parameter</em> that has the same default value and throw an informative warning.</li><li>Else, throw an informative error saying exactly which originally provided variable introduced this new &quot;process-less&quot; variable.</li></ul></li><li>Throw an informative error if a variable has two processes assigned to it (by mistake).</li></ol><p>In our experience, and as we also highlight explicitly in the online documentation, this approach typically yields simpler, less ambiguous and more targeted warning or error messages than the native MTK one&#39;s, leading to faster identification and resolution of the problems with the composed equations.</p><p>ProcessBasedModelling.jl is particularly suited for developing a model about a physical/biological/whatever system and being able to try various physical &quot;rules&quot; (couplings, feedbacks, mechanisms, ...) for a given physical observable efficiently. This means switching arbitrarily between different processes that correspond to the same variable. Hence, the target application of ProcessBasedModelling.jl is to be a framework to develop field-specific libraries that offer predefined processes without themselves relying on the existence of context-specific predefined components. An example usage is in <a href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl">ConceptualClimateModels.jl</a>.</p><p>Besides the informative errors, ProcessBasedModelling.jl also</p><ol><li>Provides a couple of common process subtypes out of the box to accelerate development of field-specific libraries.</li><li>Makes named MTK variables and parameters automatically, corresponding to parameters introduced by the by-default provided processes. This typically leads to intuitive names without being explicitly coded, while being possible to opt-out.</li><li>Provides some utility functions for further building field-specific libraries.</li></ol><p>See the documentation online for details on how to use this package as well as examples highlighting its usefulness.</p><p>ProcessBasedModelling.jl development is funded by UKRI&#39;s Engineering and Physical Sciences Research Council, grant no. EP/Y01653X/1 (grant agreement for a EU Marie Sklodowska-Curie Postdoctoral Fellowship).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/ProcessBasedModelling.jl#L4-L43">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Basic familiarity with ModelingToolkit.jl</header><div class="admonition-body"><p>These docs assume that you have some basic familiarity with ModelingToolkit.jl. If you don&#39;t going through the introductory tutorial of <a href="https://docs.sciml.ai/ModelingToolkit/stable/">ModelingToolkit.jl</a> should be enough to get you started!</p></div></div><div class="admonition is-info"><header class="admonition-header">Default `t` is unitless</header><div class="admonition-body"><p>Like ModelingToolkit.jl, ProcessBasedModelling.jl also exports <code>t</code> as the independent variable representing time. However, instead of the default <code>t</code> of ModelingToolkit.jl, here <code>t</code> is unitless. Do <code>t = ModelingToolkit.t</code> to obtain the unitful version of <code>t</code>.</p></div></div><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>In ProcessBasedModelling.jl, each variable is governed by a &quot;process&quot;. Conceptually this is just an equation that <em>defines</em> the given variable. To couple the variable with the process it is governed by, a user either defines simple equations of the form &quot;variable = expression&quot;, or creates an instance of <a href="#ProcessBasedModelling.Process"><code>Process</code></a> if the left-hand-side of the equation needs to be anything more complex (or, simply if you want to utilize the conveniences of predefined processes). In either case, the variable and the expression are both <em>symbolic expressions</em> created via ModellingToolkit.jl (more specifically, via Symbolics.jl).</p><p>Once all the processes about the physical system are collected, they are given as a <code>Vector</code> to the <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a> central function, similarly to how one gives a <code>Vector</code> of <code>Equation</code>s to e.g., <code>ModelingToolkit.ODESystem</code>. This function also defines what quantifies as a &quot;process&quot; in more specificity.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>Let&#39;s say we want to build the system of equations</p><p class="math-container">\[\dot{z} = x^2 - z \\
\dot{x} = 0.1y \\
y = z - x\]</p><p>symbolically using ModelingToolkit.jl (<strong>MTK</strong>). We define</p><pre><code class="language-julia hljs">using ModelingToolkit

@variables t # independent variable _without_ units
@variables z(t) = 0.0
@variables x(t) # no default value
@variables y(t) = 0.0</code></pre><p class="math-container">\[ \begin{equation}
\left[
\begin{array}{c}
y\left( t \right) \\
\end{array}
\right]
\end{equation}
 \]</p><p>ProcessBasedModelling.jl (<strong>PBM</strong>) strongly recommends that all defined variables have a default value at definition point. Here we didn&#39;t do this for <span>$x$</span> to illustrate what how such an &quot;omission&quot; will be treated by <strong>PBM</strong>.</p><div class="admonition is-info"><header class="admonition-header">ModelingToolkit.jl is re-exported</header><div class="admonition-body"><p>ProcessBasedModelling.jl re-exports the whole <code>ModelingToolkit</code> package, so you don&#39;t need to be <code>using</code> both of them, just <code>using ProcessBasedModelling</code>.</p></div></div><p>To make the equations we want, we can use MTK directly, and call</p><pre><code class="language-julia hljs">eqs = [
  Differential(t)(z) ~ x^2 - z
  Differential(t)(x) ~ 0.1y
  y ~ z - x
]

model = ODESystem(eqs, t; name = :example)

equations(model)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} z\left( t \right)}{\mathrm{d}t} =&amp;  - z\left( t \right) + \left( x\left( t \right) \right)^{2} \\
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} =&amp; 0.1 y\left( t \right) \\
y\left( t \right) =&amp;  - x\left( t \right) + z\left( t \right)
\end{align}
 \]</p><p>All good. Now, if we missed the process for one variable (because of our own error/sloppyness/very-large-codebase), MTK will throw an error when we try to <em>structurally simplify</em> the model (a step necessary before solving the ODE problem):</p><pre><code class="language-julia hljs">model = ODESystem(eqs[1:2], t; name = :example)
model = structural_simplify(model)</code></pre><pre><code class="nohighlight hljs">ERROR: ExtraVariablesSystemException: The system is unbalanced.
There are 3 highest order derivative variables and 2 equations.
More variables than equations, here are the potential extra variable(s):
 z(t)
 x(t)
 y(t)</code></pre><p>The error message is unhelpful as all variables are reported as &quot;potentially missing&quot;. At least on the basis of our scientific reasoning however, both <span>$x, z$</span> have an equation. It is <span>$y$</span> that <span>$x$</span> introduced that does not have an equation. Moreover, in our experience these error messages become increasingly less accurate or helpful when a model has many equations and/or variables. This makes it difficult to quickly find out where the &quot;mistake&quot; happened in the equations.</p><p><strong>PBM</strong> resolves these problems and always gives accurate error messages when it comes to the construction of the system of equations. This is because on top of the variable map that MTK constructs automatically, <strong>PBM</strong> requires the user to implicitly provide a map of variables to processes that govern said variables. <strong>PBM</strong> creates the map automatically, the only thing the user has to do is to define the equations in terms of what <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a> wants (which are either <a href="#ProcessBasedModelling.Process"><code>Process</code></a>es or <code>Equation</code>s as above).</p><p>For the majority of cases, <strong>PBM</strong> can infer the LHS variable a process &quot;defines&quot; automatically, just by passing in a vector of <code>Equation</code>s, like in <strong>MTK</strong>. For cases where this is not possible a dedicated <code>Process</code> type is provided, whose subtypes act as wrappers around equations providing some additional conveniences.</p><p>Here is what the user defines to make the same system of equations via <strong>PBM</strong>:</p><pre><code class="language-julia hljs">using ProcessBasedModelling

processes = [
    ExpRelaxation(z, x^2),      # defines z, introduces x; `Process` subtype (optional)
    Differential(t)(x) ~ 0.1*y, # defines x, introduces y; normal `Equation`
    y ~ z - x,                  # defines y; normal `Equation`
]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Any}:
 ExpRelaxation(z(t), x(t)^2, nothing)
 Differential(t)(x(t)) ~ 0.1y(t)
 y(t) ~ -x(t) + z(t)</code></pre><p>which is then given to</p><pre><code class="language-julia hljs">model = processes_to_mtkmodel(processes; name = :example)
equations(model)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} z\left( t \right)}{\mathrm{d}t} =&amp;  - z\left( t \right) + \left( x\left( t \right) \right)^{2} \\
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} =&amp; 0.1 y\left( t \right) \\
y\left( t \right) =&amp;  - x\left( t \right) + z\left( t \right)
\end{align}
 \]</p><p>Notice that the resulting <strong>MTK</strong> model is not <code>structural_simplify</code>-ed, to allow composing it with other models. By default <code>t</code> is taken as the independent variable.</p><p>Now, in contrast to before, if we &quot;forgot&quot; a process, <strong>PBM</strong> will react accordingly. For example, if we forgot the 2nd process, then the construction will error informatively, telling us exactly which variable is missing, and because of which processes it is missing:</p><pre><code class="language-julia hljs">model = processes_to_mtkmodel(processes[[1, 3]])</code></pre><pre><code class="nohighlight hljs">ERROR: ArgumentError: Variable x(t) was introduced in process of variable z(t).
However, a process for x(t) was not provided,
there is no default process for x(t), and (t)x doesn&#39;t have a default value.
Please provide a process for variable x(t).</code></pre><p>If instead we &quot;forgot&quot; the <span>$y$</span> process, <strong>PBM</strong> will not error, but warn, and make <span>$y$</span> equal to a named parameter, since <span>$y$</span> has a default value. So, running:</p><pre><code class="language-julia hljs">model = processes_to_mtkmodel(processes[1:2])
equations(model)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} z\left( t \right)}{\mathrm{d}t} =&amp;  - z\left( t \right) + \left( x\left( t \right) \right)^{2} \\
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} =&amp; 0.1 y\left( t \right) \\
y\left( t \right) =&amp; y_{0}
\end{align}
 \]</p><p>Makes the named parameter:</p><pre><code class="language-julia hljs">parameters(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{SymbolicUtils.BasicSymbolic{Real}}:
 y_0</code></pre><p>and throws the warning:</p><pre><code class="language-julia hljs">┌ Warning: Variable y(t) was introduced in process of variable x(t).
│ However, a process for y(t) was not provided,
│ and there is no default process for it either.
│ Since it has a default value, we make it a parameter by adding a process:
│ `ParameterProcess(y)`.
└ @ ProcessBasedModelling ...\ProcessBasedModelling\src\make.jl:65</code></pre><p>Lastly, <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a> also allows the concept of &quot;default&quot; processes, that can be used for introduced &quot;process-less&quot; variables. Default processes are like <code>processes</code> and given as a 2nd argument to <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a>. For example,</p><pre><code class="language-julia hljs">model = processes_to_mtkmodel(processes[1:2], processes[3:3])
equations(model)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} z\left( t \right)}{\mathrm{d}t} =&amp;  - z\left( t \right) + \left( x\left( t \right) \right)^{2} \\
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} =&amp; 0.1 y\left( t \right) \\
y\left( t \right) =&amp;  - x\left( t \right) + z\left( t \right)
\end{align}
 \]</p><p>does not throw any warnings as it obtained a process for <span>$y$</span> from the given default processes.</p><h2 id="Special-handling-of-timescales"><a class="docs-heading-anchor" href="#Special-handling-of-timescales">Special handling of timescales</a><a id="Special-handling-of-timescales-1"></a><a class="docs-heading-anchor-permalink" href="#Special-handling-of-timescales" title="Permalink"></a></h2><p>In dynamical systems modelling the timescale associated with a process is a special parameter. That is why, if a timescale is given for either the <a href="#ProcessBasedModelling.TimeDerivative"><code>TimeDerivative</code></a> or <a href="#ProcessBasedModelling.ExpRelaxation"><code>ExpRelaxation</code></a> processes, it is converted to a named <code>@parameter</code> by default:</p><pre><code class="language-julia hljs">processes = [
    ExpRelaxation(z, x^2, 2.0),    # third argument is the timescale
    TimeDerivative(x, 0.1*y, 0.5), # third argument is the timescale
    y ~ z-x,
]

model = processes_to_mtkmodel(processes)
equations(model)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} z\left( t \right)}{\mathrm{d}t} \tau_{z} =&amp;  - z\left( t \right) + \left( x\left( t \right) \right)^{2} \\
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} \tau_{x} =&amp; 0.1 y\left( t \right) \\
y\left( t \right) =&amp;  - x\left( t \right) + z\left( t \right)
\end{align}
 \]</p><pre><code class="language-julia hljs">parameters(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{SymbolicUtils.BasicSymbolic{Real}}:
 τ_z
 τ_x</code></pre><p>This special handling is also why each process can declare a timescale via the <a href="#ProcessBasedModelling.timescale"><code>ProcessBasedModelling.timescale</code></a> function that one can optionally extend (although in our experience the default behaviour covers almost all cases).</p><h2 id="Main-API-function"><a class="docs-heading-anchor" href="#Main-API-function">Main API function</a><a id="Main-API-function-1"></a><a class="docs-heading-anchor-permalink" href="#Main-API-function" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.processes_to_mtkmodel" href="#ProcessBasedModelling.processes_to_mtkmodel"><code>ProcessBasedModelling.processes_to_mtkmodel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">processes_to_mtkmodel(processes::Vector, default::Vector = []; kw...)</code></pre><p>Construct a ModelingToolkit.jl model/system using the provided <code>processes</code> and <code>default</code> processes. The model/system is <em>not</em> structurally simplified.</p><p><code>processes</code> is a vector whose elements can be:</p><ol><li>Any instance of a subtype of <a href="#ProcessBasedModelling.Process"><code>Process</code></a>. <code>Process</code> is a wrapper around <code>Equation</code> that provides some conveniences, e.g., handling of timescales or not having limitations on the left-hand-side (LHS) form.</li><li>An <code>Equation</code>. The LHS format of the equation is limited. Let <code>x</code> be a <code>@variable</code> and <code>p</code> be a <code>@parameter</code>. Then, the LHS can only be one of: <code>x</code>, <code>Differential(t)(x)</code>, <code>Differential(t)(x)*p</code>, <code>p*Differential(t)(x)</code>. Anything else will either error or fail unexpectedly.</li><li>A vector of the above two, which is then expanded. This allows the convenience of functions representing a physical process that may require many equations to be defined.</li><li>A ModelingToolkit.jl <code>XDESystem</code>, in which case the <code>equations</code> of the system are expanded as if they were given as a vector of equations like above. This allows the convenience of straightforwardly coupling already existing systems.</li></ol><p><code>default</code> is a vector that can contain the first two possibilities only as it contains default processes that may be assigned to individual variables introduced in <code>processes</code> but they don&#39;t themselves have an assigned process.</p><p>It is expected that downstream packages that use ProcessBasedModelling.jl to make a field-specific library implement a 1-argument version of <code>processes_to_mtkmodel</code>, or provide a wrapper function for it, and add a default value for <code>default</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>type = ODESystem</code>: the model type to make</li><li><code>name = nameof(type)</code>: the name of the model</li><li><code>independent = t</code>: the independent variable (default: <code>@variables t</code>). <code>t</code> is also exported by ProcessBasedModelling.jl for convenience.</li><li><code>warn_default::Bool = true</code>: if <code>true</code>, throw a warning when a variable does not have an assigned process but it has a default value so that it becomes a parameter instead.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/make.jl#L1-L38">source</a></section></article><h2 id="predefined_processes"><a class="docs-heading-anchor" href="#predefined_processes">Predefined <code>Process</code> subtypes</a><a id="predefined_processes-1"></a><a class="docs-heading-anchor-permalink" href="#predefined_processes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.ParameterProcess" href="#ProcessBasedModelling.ParameterProcess"><code>ProcessBasedModelling.ParameterProcess</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ParameterProcess(variable, value = default_value(variable)) &lt;: Process</code></pre><p>The simplest process which equates a given <code>variable</code> to a constant value that is encapsulated in a parameter. If <code>value isa Real</code>, then a named parameter with the name of <code>variable</code> and <code>_0</code> appended is created. Else, if <code>valua isa Num</code> then it is taken as the paremeter directly.</p><p>Example:</p><pre><code class="language-julia hljs">@variables T(t) = 0.5
proc = ParameterProcess(T)</code></pre><p>will create the equation <code>T ~ T_0</code>, where <code>T_0</code> is a <code>@parameter</code> with default value <code>0.5</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/processes_basic.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.TimeDerivative" href="#ProcessBasedModelling.TimeDerivative"><code>ProcessBasedModelling.TimeDerivative</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TimeDerivative(variable, expression [, τ])</code></pre><p>The second simplest process that equates the time derivative of the <code>variable</code> to the given <code>expression</code> while providing some conveniences over manually constructing an <code>Equation</code>.</p><p>It creates the equation <code>τ_$(variable) Differential(t)(variable) ~ expression</code> by constructing a new <code>@parameter</code> with default value <code>τ</code> (if <code>τ</code> is already a <code>@parameter</code>, it is used as-is). If <code>τ</code> is not given, then 1 is used at its place and no parameter is created.</p><p>Note that if <code>iszero(τ)</code>, then the process <code>variable ~ expression</code> is created.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/processes_basic.jl#L28-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.ExpRelaxation" href="#ProcessBasedModelling.ExpRelaxation"><code>ProcessBasedModelling.ExpRelaxation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExpRelaxation(variable, expression [, τ]) &lt;: Process</code></pre><p>A common process for creating an exponential relaxation of <code>variable</code> towards the given <code>expression</code>, with timescale <code>τ</code>. It creates the equation:</p><pre><code class="nohighlight hljs">τn*Differential(t)(variable) ~ expression - variable</code></pre><p>Where <code>τn</code> is a new named <code>@parameter</code> with the value of <code>τ</code> and name <code>τ_($(variable))</code>. If instead <code>τ</code> is <code>nothing</code>, then 1 is used in its place (this is the default behavior). If <code>iszero(τ)</code>, then the equation <code>variable ~ expression</code> is created instead.</p><p>The convenience function</p><pre><code class="language-julia hljs">ExpRelaxation(process, τ)</code></pre><p>allows converting an existing process (or equation) into an exponential relaxation by using the <code>rhs(process)</code> as the <code>expression</code> in the equation above.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/processes_basic.jl#L52-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.AdditionProcess" href="#ProcessBasedModelling.AdditionProcess"><code>ProcessBasedModelling.AdditionProcess</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AdditionProcess(process, added...)</code></pre><p>A convenience process for adding processes <code>added</code> to the <code>rhs</code> of the given <code>process</code>. <code>added</code> can be a single symbolic expression. Otherwise, <code>added</code> can be a <code>Process</code> or <code>Equation</code>, or multitude of them, in which case it is checked that the <code>lhs_variable</code> across all added components matches the <code>process</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/processes_basic.jl#L93-L100">source</a></section></article><h2 id="Process-API"><a class="docs-heading-anchor" href="#Process-API"><code>Process</code> API</a><a id="Process-API-1"></a><a class="docs-heading-anchor-permalink" href="#Process-API" title="Permalink"></a></h2><p>This API describes how you can implement your own <code>Process</code> subtype, if the <a href="#predefined_processes">existing predefined subtypes</a> don&#39;t fit your bill!</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.Process" href="#ProcessBasedModelling.Process"><code>ProcessBasedModelling.Process</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Process</code></pre><p>A new process must subtype <code>Process</code> and can be used in <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a>. The type must extend the following functions from the module <code>ProcessBasedModelling</code>:</p><ul><li><code>lhs_variable(p)</code> which returns the variable the process describes (left-hand-side variable). There is a default implementation <code>lhs_variable(p) = p.variable</code> if the field exists.</li><li><code>rhs(p)</code> which is the right-hand-side expression, i.e., the &quot;actual&quot; process.</li><li>(optional) <code>timescale(p)</code>, which defaults to <a href="#ProcessBasedModelling.NoTimeDerivative"><code>NoTimeDerivative</code></a>.</li><li>(optional) <code>lhs(p)</code> which returns the left-hand-side. Let <code>τ = timescale(p)</code>. Then default <code>lhs(p)</code> behaviour depends on <code>τ</code> as follows:<ul><li>Just <code>lhs_variable(p)</code> if <code>τ == NoTimeDerivative()</code>.</li><li><code>Differential(t)(p)</code> if <code>τ == nothing</code>.</li><li><code>τ_var*Differential(t)(p)</code> if <code>τ isa Union{Real, Num}</code>. If real, a new named parameter <code>τ_var</code> is created that has the prefix <code>:τ_</code> and then the lhs-variable name and has default value <code>τ</code>. Else if <code>Num</code>, <code>τ_var = τ</code> as given.</li><li>Explicitly extend <code>lhs_variable</code> if the above do not suit you.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/API.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.lhs_variable" href="#ProcessBasedModelling.lhs_variable"><code>ProcessBasedModelling.lhs_variable</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ProcessBasedModelling.lhs_variable(p::Process)</code></pre><p>Return the variable (a single symbolic variable) corresponding to <code>p</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/API.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.rhs" href="#ProcessBasedModelling.rhs"><code>ProcessBasedModelling.rhs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ProcessBasedModelling.rhs(process)</code></pre><p>Return the right-hand-side of the equation governing the process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/API.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.timescale" href="#ProcessBasedModelling.timescale"><code>ProcessBasedModelling.timescale</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ProcessBasedModelling.timescale(p::Process)</code></pre><p>Return the timescale associated with <code>p</code>. See <a href="#ProcessBasedModelling.Process"><code>Process</code></a> for more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/API.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.NoTimeDerivative" href="#ProcessBasedModelling.NoTimeDerivative"><code>ProcessBasedModelling.NoTimeDerivative</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ProcessBasedModelling.NoTimeDerivative()</code></pre><p>Singleton value that is the default output of the <code>timescale</code> function for variables that do not vary in time autonomously, i.e., they have no d/dt derivative and hence the concept of a &quot;timescale&quot; does not apply to them.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/API.jl#L23-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.lhs" href="#ProcessBasedModelling.lhs"><code>ProcessBasedModelling.lhs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ProcessBasedModelling.lhs(p::Process)
ProcessBasedModelling.lhs(eq::Equation)</code></pre><p>Return the right-hand-side of the equation governing the process. If <code>timescale</code> is implemented for <code>p</code>, typically <code>lhs</code> does not need to be as well. See <a href="#ProcessBasedModelling.Process"><code>Process</code></a> for more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/API.jl#L52-L59">source</a></section></article><h2 id="Automatic-named-parameters"><a class="docs-heading-anchor" href="#Automatic-named-parameters">Automatic named parameters</a><a id="Automatic-named-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Automatic-named-parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.new_derived_named_parameter" href="#ProcessBasedModelling.new_derived_named_parameter"><code>ProcessBasedModelling.new_derived_named_parameter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">new_derived_named_parameter(variable, value, extra::String; kw...)</code></pre><p>If <code>value isa Num</code> return <code>value</code>. If <code>value isa LiteralParameter</code>, replace it with its literal value. Otherwise, create a new MTK <code>@parameter</code> whose name is created from <code>variable</code> (which could also be just a <code>Symbol</code>) by adding the <code>extra</code> string.</p><p><strong>Keywords</strong>:</p><ul><li><code>prefix = true</code>: whether the <code>extra</code> is added at the start or the end, connecting with the with the <code>connector</code>.</li><li><code>connector = &quot;_&quot;</code>: what to use to connect <code>extra</code> with the name.</li></ul><p>For example,</p><pre><code class="nohighlight hljs">@variables x(t)
p = new_derived_named_parameter(x, 0.5, &quot;τ&quot;)</code></pre><p>Now <code>p</code> will be a parameter with name <code>:τ_x</code> and default value <code>0.5</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/utils.jl#L88-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.@convert_to_parameters" href="#ProcessBasedModelling.@convert_to_parameters"><code>ProcessBasedModelling.@convert_to_parameters</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@convert_to_parameters vars...</code></pre><p>Convert all variables <code>vars</code> into <code>@parameters</code> with name the same as <code>vars</code> and default value the same as the value of <code>vars</code>. The macro leaves unaltered inputs that are of type <code>Num</code>, assumming they are already parameters. It also replaces <a href="#ProcessBasedModelling.LiteralParameter"><code>LiteralParameter</code></a> inputs with its literal values. This macro is extremely useful to convert e.g., keyword arguments into named parameters, while also allowing the user to give custom parameter names, or to leave some keywords as numeric literals.</p><p>Example:</p><pre><code class="nohighlight hljs">julia&gt; A, B = 0.5, 0.5
(0.5, 0.5)

julia&gt; C = first(@parameters X = 0.5)

julia&gt; @convert_to_parameters A B C
3-element Vector{Num}:
 A
 B
 X

julia&gt; typeof(A) # `A` is not a number anymore!
Num

julia&gt; default_value(A)
0.5

julia&gt; C # the binding `C` still corresponds to parameter named `:X`!
 X</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/utils.jl#L130-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.LiteralParameter" href="#ProcessBasedModelling.LiteralParameter"><code>ProcessBasedModelling.LiteralParameter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LiteralParameter(p)</code></pre><p>A wrapper around a value <code>p</code> to indicate to <a href="#ProcessBasedModelling.new_derived_named_parameter"><code>new_derived_named_parameter</code></a> or <a href="#ProcessBasedModelling.@convert_to_parameters"><code>@convert_to_parameters</code></a> to <em>not</em> convert the given parameter <code>p</code> into a named <code>@parameters</code> instance, but rather keep it as a numeric literal in the generated equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/utils.jl#L1-L8">source</a></section></article><h2 id="Utility-functions"><a class="docs-heading-anchor" href="#Utility-functions">Utility functions</a><a id="Utility-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.default_value" href="#ProcessBasedModelling.default_value"><code>ProcessBasedModelling.default_value</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">default_value(x)</code></pre><p>Return the default value of a symbolic variable <code>x</code> or <code>nothing</code> if it doesn&#39;t have any. Return <code>x</code> if <code>x</code> is not a symbolic variable. The difference with <code>ModelingToolkit.getdefault</code> is that this function will not error on the absence of a default value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/utils.jl#L52-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.has_symbolic_var" href="#ProcessBasedModelling.has_symbolic_var"><code>ProcessBasedModelling.has_symbolic_var</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">has_symbolic_var(eqs, var)</code></pre><p>Return <code>true</code> if symbolic variable <code>var</code> exists in the equation(s) <code>eq</code>, <code>false</code> otherwise. This works for either <code>@parameters</code> or <code>@variables</code>. If <code>var</code> is a <code>Symbol</code> isntead of a <code>Num</code>, all variables are converted to their names and equality is checked on the basis of the name only.</p><pre><code class="nohighlight hljs">has_symbolic_var(model, var)</code></pre><p>When given a MTK model (such as <code>ODESystem</code>) search in <em>all</em> the equations of the system, including observed variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/f41091a986513b6cac8d7efc4cf8467b3a5d8490/src/utils.jl#L16-L28">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Sunday 31 March 2024 11:45">Sunday 31 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
